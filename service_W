heat_template_version: 2014-10-16

resources:
  compute_instance:
    type: "OS::Nova::Server"
    properties:
      flavor: m1.small
      image: debian8 
      name: serveurW
      networks:
          - subnet: subnet2
      key_name: id-rsa
      user_data: |
         #!/bin/bash 
         wget -P /tmp https://github.com/JEDemets/EnsimagOpenstackG7/archive/application_structure.zip > /tmp/log
         apt-get install unzip >> tmp/log
         unzip /tmp/application_structure.zip -d tmp/app >> tmp/log
         sh /tmp/app/EnsimagOpenstackG7-application_structure/worker.sh >> tmp/log

outputs:
   serviceI_IP:
      value: {get_attr: [ compute_instance, first_address ] }
